<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Impressão Etiquetas 58mm</title>

<style>
/* ================== PADRÃO ================== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, Helvetica, sans-serif;
}

/* ================== ETIQUETA ================== */
.etiqueta {
    width: 58mm;
    padding: 3mm 2mm;
    border-bottom: 1px dashed #000;
}

.etiqueta-produto {
    font-size: 9pt;
    font-weight: bold;
    margin-bottom: 2mm;
    line-height: 1.2;
    word-wrap: break-word;
}

.etiqueta-preco {
    display: flex;
    align-items: baseline;
    font-weight: 900;
}

.preco-simbolo {
    font-size: 12pt;
    margin-right: 1mm;
}

.preco-inteiro {
    font-size: 34pt;
    line-height: 1;
}

.preco-centavos {
    font-size: 14pt;
    margin-left: 1px;
}

/* ================== PRINT ================== */
@media print {

    @page {
        size: 58mm;
        margin: 0;
    }

    body {
        width: 58mm;
        margin: 0;
        padding: 0;
    }

    .container {
        display: none !important;
    }

    #printArea {
        display: block !important;
        width: 58mm;
    }

    .etiqueta {
        page-break-after: always;
    }
}
</style>
</head>

<body>

<!-- ===== INTERFACE (NÃO IMPRIME) ===== -->
<div class="container" style="padding:20px">
    <h2>Sistema de Etiquetas 58mm</h2>

    <table id="produtosTable">
        <tbody id="tableBody">
            <tr>
                <td><input class="produto" placeholder="Produto"></td>
                <td><input class="preco" placeholder="Preço"></td>
            </tr>
        </tbody>
    </table>

    <button onclick="addRow()">Adicionar</button>
    <button onclick="printLabels()">Imprimir</button>
</div>

<!-- ===== ÁREA DE IMPRESSÃO ===== -->
<div id="printArea" style="display:none"></div>

<script>
function addRow() {
    const tr = document.createElement('tr');
    tr.innerHTML = `
        <td><input class="produto" placeholder="Produto"></td>
        <td><input class="preco" placeholder="Preço"></td>
    `;
    document.getElementById('tableBody').appendChild(tr);
}

function formatarPreco(valor) {
    valor = valor.replace(/[^\d,\.]/g,'').replace('.',',');
    let [i,c] = valor.split(',');
    if (!i) i = '0';
    if (!c) c = '00';
    if (c.length === 1) c += '0';
    return { i, c };
}

function printLabels() {
    const rows = document.querySelectorAll('#tableBody tr');
    const printArea = document.getElementById('printArea');
    printArea.innerHTML = '';

    let ok = false;

    rows.forEach(r => {
        const produto = r.querySelector('.produto').value.trim();
        const preco = r.querySelector('.preco').value.trim();
        if (produto && preco) {
            ok = true;
            const p = formatarPreco(preco);
            printArea.innerHTML += `
                <div class="etiqueta">
                    <div class="etiqueta-produto">${produto}</div>
                    <div class="etiqueta-preco">
                        <span class="preco-simbolo">R$</span>
                        <span class="preco-inteiro">${p.i}</span>
                        <span class="preco-centavos">,${p.c}</span>
                    </div>
                </div>
            `;
        }
    });

    if (!ok) {
        alert('Nenhuma etiqueta válida.');
        return;
    }

    setTimeout(() => window.print(), 300);
}
</script>

</body>
</html>
